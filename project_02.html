<!DOCTYPE html>
<html lang="zh-TW" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新竹縣警察局 | 雲端智慧影像分析系統 (APP Ver.) - UI/UX Case Study</title>

    <link href="./img/favicon/favicon.ico" rel="shortcut icon" type="image/ico">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/ScrollToPlugin.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link
        href="https://fonts.googleapis.com/css2?family=Momo+Trust+Display&family=Noto+Sans+TC:wght@300;400;500;700;900&family=Quicksand:wght@300..700&display=swap"
        rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#ff4a00',
                        secondary: '#FFD700', // Yellow
                        // Dark Theme Colors (Warm/Coffee tones)
                        dark: '#080201',
                        'dark-light': '#140502',
                        'dark-lighter': '#240a05',
                        accent: '#F5F5DC',
                        'soft-bg': '#F0F2F5',
                    },
                    fontFamily: {
                        sans: ['Quicksand', '"Noto Sans TC"', 'sans-serif'],
                        heading: ['"Momo Trust Display"', '"Noto Sans TC"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* === 基礎設定 === */
        body,
        html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #080201;
            font-family: 'Quicksand', 'Noto Sans TC', sans-serif;
            color: #fff;
            overflow: hidden;
            overscroll-behavior: none;
        }

        /* === 主捲動容器 === */
        #main-scroller {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* === 全頁滾動區塊 === */
        .snap-section {
            width: 100vw;
            height: 100vh;
            position: relative;
            opacity: 0;
            visibility: hidden;
            transition: opacity 1s ease-in-out;
            display: flex;
            flex-direction: column;
        }

        .snap-section.active-section {
            opacity: 1;
            visibility: visible;
        }

        /* === 內容滾動區域 === */
        .scroll-content {
            overflow-y: auto !important;
            touch-action: pan-y !important;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
            height: 100%;
        }

        /* UI Elements */
        .glass-panel {
            background: linear-gradient(135deg, rgba(20, 5, 2, 0.95), rgba(8, 2, 1, 0.98));
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Feature Card Styles */
        .feature-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.03), rgba(255, 255, 255, 0.01));
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-2px);
            border-color: rgba(255, 74, 0, 0.4);
            box-shadow: 0 10px 30px -10px rgba(255, 74, 0, 0.2);
        }

        .feature-card.active {
            border-color: #ff4a00;
            background: rgba(255, 255, 255, 0.05);
            box-shadow: 0 0 15px rgba(255, 74, 0, 0.1);
        }

        /* Scrollbars */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .custom-scroll::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scroll::-webkit-scrollbar-thumb {
            background: #240a05;
            border-radius: 4px;
        }

        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #ff4a00;
        }

        /* Animations */
        .fade-in-up {
            animation: fadeInUp 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            opacity: 0;
            transform: translateY(40px);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fadeIn {
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Skeleton Loading Animation */
        @keyframes pulse-bg {

            0%,
            100% {
                background-color: rgba(255, 255, 255, 0.05);
            }

            50% {
                background-color: rgba(255, 255, 255, 0.15);
            }
        }

        .skeleton-loader {
            animation: pulse-bg 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 10;
        }

        /* Comparison Slider Styles */
        .comparison-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .comparison-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .comparison-slider {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #ff4a00;
            cursor: ew-resize;
            z-index: 20;
            /* Increased z-index to be above skeletons */
        }

        /* Fixed vertical centering */
        .comparison-handle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 32px;
            height: 32px;
            background: #ff4a00;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        /* Hero Background Custom */
        .hero-bg-custom {
            /* Fallback for older browsers */
            background-image: url('./img/project_02/hero_img.jpg');

            /* Modern browsers: choose between WebP and JPG */
            background-image: -webkit-image-set(url('./img/project_02/hero_img.webp') 1x,
                    url('./img/project_02/hero_img.jpg') 1x);
            background-image: image-set(url('./img/project_02/hero_img.webp') 1x,
                    url('./img/project_02/hero_img.jpg') 1x);

            background-size: cover;
            background-position: center;
        }

        .hero-bg-custom::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom, rgba(8, 2, 1, 0.2) 0%, rgba(8, 2, 1, 0.5) 100%);
            z-index: 1;
        }

        /* Back Button Styles */
        .back-btn i {
            transition: transform 0.3s ease;
        }

        .back-btn:hover i {
            transform: translateX(-4px);
        }

        /* Loader */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0F1115;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        .loader.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loader-animation {
            width: 65px;
            aspect-ratio: 1;
            position: relative;
        }

        .loader-animation:before,
        .loader-animation:after {
            content: "";
            position: absolute;
            border-radius: 50px;
            box-shadow: 0 0 0 3px inset #fff;
            animation: l4 2.5s infinite;
        }

        .loader-animation:after {
            animation-delay: -1.25s;
        }

        @keyframes l4 {
            0% {
                inset: 0 35px 35px 0;
            }

            12.5% {
                inset: 0 35px 0 0;
            }

            25% {
                inset: 35px 35px 0 0;
            }

            37.5% {
                inset: 35px 0 0 0;
            }

            50% {
                inset: 35px 0 0 35px;
            }

            62.5% {
                inset: 0 0 0 35px;
            }

            75% {
                inset: 0 0 35px 35px;
            }

            87.5% {
                inset: 0 0 35px 0;
            }

            100% {
                inset: 0 35px 35px 0;
            }
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- HELPER COMPONENTS ---

        const ResponsiveImage = ({ src, className, alt, style, onLoad, ...props }) => {
            if (!src) return null;
            const webpSrc = src.replace(/\.(jpg|jpeg|png)$/i, '.webp');

            return (
                <picture style={{ display: 'contents' }}>
                    <source srcSet={webpSrc} type="image/webp" />
                    <img
                        src={src}
                        className={className}
                        alt={alt}
                        style={style}
                        onLoad={onLoad}
                        {...props}
                    />
                </picture>
            );
        };

        const ImageWithSkeleton = ({ src, alt, className, containerClassName }) => {
            const [loaded, setLoaded] = useState(false);

            useEffect(() => {
                setLoaded(false);
            }, [src]);

            return (
                <div className={`relative w-full h-full overflow-hidden ${containerClassName || ''}`}>
                    {!loaded && (
                        <div className="skeleton-loader"></div>
                    )}
                    <ResponsiveImage
                        src={src}
                        alt={alt}
                        className={`${className} transition-opacity duration-500 ease-in-out ${loaded ? 'opacity-100' : 'opacity-0'}`}
                        onLoad={() => setLoaded(true)}
                    />
                </div>
            );
        };

        // --- 1. 多語言資料庫與翻譯 ---
        const TRANSLATIONS = {
            zh: {
                title_main: "新竹縣警察局",
                title_sub: "APP 雲端影像分析系統",
                hero_desc: "將龐大的警政後台裝進口袋。採用現代化輕擬態 (Soft UI) 設計，針對戶外執勤優化，實現「車過即知、指尖辦案」的行動即戰力。",
                btn_explore: "探索設計旅程",
                tab_context: "01. 背景",
                tab_focus: "02. 取捨與精簡",
                tab_features: "03. 特色對照",
                tab_gallery: "04. 介面鑑賞",
                context_title: "設計挑戰：從複雜後台到行動指尖",
                context_desc: "傳統警政系統功能繁雜、數據量大，通常依賴滑鼠鍵盤在大螢幕上操作。然而，外勤員警需要在風吹日曬的戶外環境下，透過小尺寸的手機螢幕快速獲取關鍵情資。",
                mobile_first: "行動優先",
                mobile_first_sub: "針對單手操作與觸控優化",
                soft_ui: "輕擬態風格",
                soft_ui_sub: "柔和介面減輕視覺疲勞",
                focus_title: "行動化的取捨與精簡",
                focus_sub: "Web vs App 的設計策略對比",
                features_title: "APP 特色呈現",
                features_sub: "點擊下方項目，左側將顯示 Before/After 對照",
                drag_hint: "拖曳滑桿比較 Web vs App 差異",
                gallery_title: "介面總覽 Gallery",
                web_complex: "WEB (Complex)",
                app_simple: "APP (Simple)",
                back_home: "Back to Portfolio"
            },
            en: {
                title_main: "Hsinchu County Police",
                title_sub: "Cloud Video Analysis App",
                hero_desc: "Fitting the massive police backend into a pocket. Adopting modern Soft UI design, optimized for outdoor duty, achieving 'immediate vehicle identification' and mobile operational capability.",
                btn_explore: "Explore the Journey",
                tab_context: "01. Context",
                tab_focus: "02. Focus",
                tab_features: "03. Features",
                tab_gallery: "04. Gallery",
                context_title: "Design Challenge: From Backend to Fingertips",
                context_desc: "Traditional police systems are complex and data-heavy, relying on large screens. However, field officers need to access critical intelligence quickly on small mobile screens in outdoor environments.",
                mobile_first: "Mobile First",
                mobile_first_sub: "Optimized for one-handed touch",
                soft_ui: "Soft UI",
                soft_ui_sub: "Gentle interface reduces visual fatigue",
                focus_title: "Trade-offs & Simplification",
                focus_sub: "Web vs App Design Strategy",
                features_title: "APP Feature Highlights",
                features_sub: "Click items below to compare Before/After",
                drag_hint: "Drag slider to compare Web vs App",
                gallery_title: "Interface Gallery",
                web_complex: "WEB (Complex)",
                app_simple: "APP (Simple)",
                back_home: "Back to Portfolio"
            }
        };

        const getSimplificationPoints = (lang) => {
            const isZh = lang === 'zh';
            return [
                {
                    id: 'simple-01',
                    title: isZh ? '空間與佈局 (Space)' : 'Space & Layout',
                    icon: 'fa-layer-group',
                    web: { desc: isZh ? '多欄位、多視窗並列' : 'Multi-column, Multi-window', type: 'Complex' },
                    app: { desc: isZh ? '垂直單欄、Card UI 堆疊' : 'Vertical Single Column, Card UI', type: 'Simple' },
                    insight: isZh ? '捨棄儀表板的總覽性，換取手機直向操作的流暢度。' : 'Trade dashboard overview for smooth vertical mobile interaction.'
                },
                {
                    id: 'simple-02',
                    title: isZh ? '數據呈現 (Data)' : 'Data Presentation',
                    icon: 'fa-chart-bar',
                    web: { desc: isZh ? '詳細數據表格、參數列表' : 'Detailed Data Tables', type: 'Complex' },
                    app: { desc: isZh ? '視覺燈號、顏色警示' : 'Visual Signals, Color Alerts', type: 'Simple' },
                    insight: isZh ? '將「讀數字」轉化為「看顏色」，降低戶外判讀的認知負荷。' : 'Turn "reading numbers" into "seeing colors" to reduce cognitive load outdoors.'
                },
                {
                    id: 'simple-03',
                    title: isZh ? '任務焦點 (Task)' : 'Task Focus',
                    icon: 'fa-bullseye',
                    web: { desc: isZh ? '多功能整合 Dashboard' : 'Multifunctional Dashboard', type: 'Complex' },
                    app: { desc: isZh ? '單一任務導向 (Task-Oriented)' : 'Single Task Oriented', type: 'Simple' },
                    insight: isZh ? '每次進入頁面只專注解決一個問題（如：查車牌），避免功能干擾。' : 'Focus on one problem at a time (e.g., checking plates) to avoid distraction.'
                },
                {
                    id: 'simple-04',
                    title: isZh ? '操作互動 (Interaction)' : 'Interaction',
                    icon: 'fa-hand-pointer',
                    web: { desc: isZh ? '滑鼠精細操作、多層篩選' : 'Mouse Precision, Filters', type: 'Complex' },
                    app: { desc: isZh ? '大尺寸觸控、模糊搜尋' : 'Large Touch Targets, Fuzzy Search', type: 'Simple' },
                    insight: isZh ? '針對手指觸控優化，並加入模糊比對以應對現場輸入的不便。' : 'Optimized for touch, added fuzzy search for difficult field input.'
                }
            ];
        };

        const getAppFeatures = (lang) => {
            const isZh = lang === 'zh';
            return [
                {
                    id: 'feat-01',
                    title: isZh ? '登入與身份驗證' : 'Login & Auth',
                    desc: isZh ? '從傳統後台登入轉向更具現代感的身份驗證。' : 'Modern auth flow replacing traditional backend login.',
                    beforeImg: './img/project_01/home_01.jpg',
                    afterImg: './img/project_02/mobile_mockup_04@2x.jpg',
                    point: isZh ? '移除不必要的背景與圖片，聚焦在登入流程上。' : 'Remove unnecessary background, focus on flow.'
                },
                {
                    id: 'feat-02',
                    title: isZh ? '設備維運監控' : 'Device Monitoring',
                    desc: isZh ? '將伺服器列表轉化為直觀的燈號卡片。' : 'Transforming server lists into visual signal cards.',
                    beforeImg: './img/project_01/home_02.jpg',
                    afterImg: './img/project_02/mobile_mockup_01@2x.jpg',
                    point: isZh ? '直接顯示毫秒 (ms) 延遲，以紅/綠燈號代表連線狀態。' : 'Latency in ms, traffic light colors for status.'
                },
                {
                    id: 'feat-03',
                    title: isZh ? '車牌模糊搜尋' : 'Fuzzy Plate Search',
                    desc: isZh ? '針對現場輸入困難，提供更彈性的搜尋機制。' : 'Flexible search mechanism for difficult field input.',
                    beforeImg: './img/project_01/search_01.jpg',
                    afterImg: './img/project_02/mobile_mockup_02@2x.jpg',
                    point: isZh ? '新增「模糊比對數」與「字數」設定，解決輸入不全的問題。' : 'Added "fuzzy match count" and "length" settings.'
                },
                {
                    id: 'feat-04',
                    title: isZh ? '搜尋結果可視化' : 'Visualized Results',
                    desc: isZh ? '將表格行轉化為易讀的卡片資訊。' : 'Converting table rows into readable cards.',
                    beforeImg: './img/project_01/search_02.jpg',
                    afterImg: './img/project_02/mobile_mockup_03@2x.jpg',
                    point: isZh ? '以高亮顏色標示「失竊/通緝」，並提供大按鈕提升操作效率。' : 'Highlight Stolen/Wanted, large buttons for efficiency.'
                },
                {
                    id: 'feat-05',
                    title: isZh ? '軌跡追蹤地圖' : 'Trajectory Map',
                    desc: isZh ? '地圖介面的行動化適配。' : 'Mobile adaptation of the map interface.',
                    beforeImg: './img/project_01/track_01.jpg',
                    afterImg: './img/project_02/mobile_mockup_06@2x.jpg',
                    point: isZh ? '清晰的序號 (01, 02...) 標示路徑，小螢幕也能清楚判讀。' : 'Clear sequence markers for direction on small screens.'
                },
                {
                    id: 'feat-06',
                    title: isZh ? '智慧水情監控' : 'Smart Flood Monitor',
                    desc: isZh ? '結合即時影像與數據圖表的防災儀表板。' : 'Disaster dashboard combining video and data charts.',
                    beforeImg: './img/project_01/flood_01.jpg',
                    afterImg: './img/project_02/mobile_mockup_05@2x.jpg',
                    point: isZh ? '單一重點呈現：上方即時影像，下方長條圖水位警戒。' : 'Single focus: Video on top, water level charts below.'
                }
            ];
        };

        const getAppGallery = (lang) => {
            const isZh = lang === 'zh';
            return [
                { id: 'g01', title: isZh ? '設備狀態檢視' : 'Device Status', desc: isZh ? '即時監控各路口設備連線狀態與延遲毫秒數。' : 'Monitor connection status and latency.', src: './img/project_02/mobile_mockup_01@2x.jpg' },
                { id: 'g02', title: isZh ? '車牌模糊搜尋' : 'Fuzzy Search', desc: isZh ? '支援模糊比對與字數篩選，快速鎖定目標車輛。' : 'Fuzzy match and length filter support.', src: './img/project_02/mobile_mockup_02@2x.jpg' },
                { id: 'g03', title: isZh ? '搜尋結果卡片' : 'Result Cards', desc: isZh ? '高亮顯示失竊或通緝車輛，提供一鍵快速操作。' : 'Highlight specific vehicles, quick actions.', src: './img/project_02/mobile_mockup_03@2x.jpg' },
                { id: 'g04', title: isZh ? '系統登入' : 'Login', desc: isZh ? '簡化的登入流程。' : 'Simplified login flow.', src: './img/project_02/mobile_mockup_04@2x.jpg' },
                { id: 'g05', title: isZh ? '水情防災資訊' : 'Flood Info', desc: isZh ? '整合即時影像與水位數據，視覺化呈現災情趨勢。' : 'Integrated video and water level data.', src: './img/project_02/mobile_mockup_05@2x.jpg' },
                { id: 'g06', title: isZh ? '行車軌跡查詢' : 'Trajectory', desc: isZh ? '地圖化呈現車輛移動路徑，輔助刑偵軌跡分析。' : 'Map-based path visualization.', src: './img/project_02/mobile_mockup_06@2x.jpg' },
            ];
        };


        // --- COMPONENTS ---

        const ComparisonSlider = ({ beforeImage, afterImage }) => {
            const [sliderPosition, setSliderPosition] = useState(50);
            const containerRef = useRef(null);
            const isDragging = useRef(false);

            const handleMouseDown = () => { isDragging.current = true; };
            const handleMouseUp = () => { isDragging.current = false; };

            const handleMouseMove = (e) => {
                if (!isDragging.current || !containerRef.current) return;
                const rect = containerRef.current.getBoundingClientRect();
                const x = Math.max(0, Math.min(e.clientX - rect.left, rect.width));
                setSliderPosition((x / rect.width) * 100);
            };

            const handleTouchMove = (e) => {
                if (!isDragging.current || !containerRef.current) return;
                const rect = containerRef.current.getBoundingClientRect();
                const x = Math.max(0, Math.min(e.touches[0].clientX - rect.left, rect.width));
                setSliderPosition((x / rect.width) * 100);
            }

            useEffect(() => {
                window.addEventListener('mouseup', handleMouseUp);
                window.addEventListener('touchend', handleMouseUp);
                return () => {
                    window.removeEventListener('mouseup', handleMouseUp);
                    window.removeEventListener('touchend', handleMouseUp);
                };
            }, []);

            return (
                <div
                    ref={containerRef}
                    className="comparison-container w-full h-full relative select-none cursor-ew-resize bg-dark-light rounded-xl overflow-hidden border border-white/10"
                    onMouseMove={handleMouseMove}
                    onTouchMove={handleTouchMove}
                    onMouseDown={handleMouseDown}
                    onTouchStart={handleMouseDown}
                >
                    <div className="absolute inset-0 flex items-center justify-center bg-[#0f0402] p-4 lg:p-8">
                        <div className="w-full h-full max-w-full max-h-full flex items-center justify-center opacity-50 grayscale relative">
                            {/* [修正] Before 圖片：改為 object-contain 以確保網頁截圖完整顯示 */}
                            <ImageWithSkeleton src={beforeImage} className="w-full h-full object-contain" containerClassName="flex items-center justify-center" alt="Web Version" />
                        </div>
                    </div>
                    <div className="absolute inset-0 flex items-center justify-center bg-[#0f0402]" style={{ clipPath: `inset(0 ${100 - sliderPosition}% 0 0)` }}>
                        <div className="w-full h-full max-w-full max-h-full flex items-center justify-center">
                            <div className="relative h-full aspect-[9/19] border-[4px] md:border-[8px] border-[#2d2d2d] rounded-[1.25rem] lg:rounded-[2.5rem] overflow-hidden bg-black">
                                <ImageWithSkeleton src={afterImage} className="w-full h-full object-cover" alt="App Version" />
                            </div>
                        </div>
                    </div>
                    <div className="comparison-slider" style={{ left: `${sliderPosition}%` }}>
                        <div className="comparison-handle"><i className="fas fa-arrows-alt-h text-white text-xs"></i></div>
                    </div>
                </div>
            );
        };

        const WindowFrame = ({ src, alt }) => {
            return (
                <div className="flex items-center justify-center p-4 lg:p-12 w-full h-full">
                    <div className="w-full max-w-full h-full flex items-center justify-center">
                        <div className="relative bg-dark-light rounded-xl border border-white/10 shadow-2xl overflow-hidden flex flex-col shrink-0 animate-fadeIn w-full" style={{ maxWidth: '100%', maxHeight: '100%' }}>
                            {/* [修正] WindowFrame 圖片填滿：改為 object-cover 並設定寬高為 full */}
                            <ImageWithSkeleton src={src} alt={alt} className="block w-full h-full object-cover" />
                        </div>
                    </div>
                </div>
            );
        };

        const PhoneFrame = ({ src, alt }) => {
            return (
                <div className="flex items-center justify-center p-4 lg:p-12 w-full h-full">
                    <div className="w-full max-w-full h-full flex items-center justify-center">
                        <div className="relative h-full w-auto max-w-full aspect-[9/19] border-[6px] md:border-[8px] border-[#2d2d2d] rounded-[1.25rem] lg:rounded-[2.5rem] overflow-hidden shadow-2xl bg-black animate-fadeIn shrink-0">
                            <ImageWithSkeleton src={src} alt={alt} className="w-full h-full object-cover block" />
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [lang, setLang] = useState('zh');
            const [simplificationPoints, setSimplificationPoints] = useState([]);
            const [appFeatures, setAppFeatures] = useState([]);
            const [appGallery, setAppGallery] = useState([]);

            const [loading, setLoading] = useState(true);
            const [activeTab, setActiveTab] = useState('context');
            const [showBackToHero, setShowBackToHero] = useState(false);

            const [activeFeatureId, setActiveFeatureId] = useState('feat-01');
            const [activeGalleryId, setActiveGalleryId] = useState('g01');

            const [currentSectionIndex, setCurrentSectionIndex] = useState(0);
            const isScrollingRef = useRef(false);
            const mainContainerRef = useRef(null);
            const sectionsRef = useRef([]);
            const heroRef = useRef(null);
            const splitRef = useRef(null);
            const contentScrollRef = useRef(null);
            const overscrollAccumulator = useRef(0);
            const touchStartY = useRef(0);
            const tabsContainerRef = useRef(null);

            const [mobileVisualHeight, setMobileVisualHeight] = useState(35);
            const isResizingRef = useRef(false);

            const t = (key) => TRANSLATIONS[lang][key] || key;

            const activeFeature = appFeatures.find(f => f.id === activeFeatureId) || appFeatures[0] || {};
            const activeGalleryImg = (appGallery.find(g => g.id === activeGalleryId) || appGallery[0] || {}).src;

            useEffect(() => {
                const savedLang = localStorage.getItem('preferredLang');
                const initialLang = savedLang === 'en' ? 'en' : 'zh';
                setLang(initialLang);
                document.documentElement.lang = initialLang === 'zh' ? 'zh-TW' : 'en';

                setSimplificationPoints(getSimplificationPoints(initialLang));
                setAppFeatures(getAppFeatures(initialLang));
                setAppGallery(getAppGallery(initialLang));

                const setResponsiveFontSize = () => {
                    const minDesktopWidth = 1024;
                    let currentWidth = window.innerWidth;
                    if (currentWidth >= minDesktopWidth) {
                        const baseWidth = 1920;
                        const baseFontSize = 16;
                        let newFontSize = (currentWidth / baseWidth) * baseFontSize;
                        document.documentElement.style.fontSize = newFontSize + "px";
                    } else {
                        document.documentElement.style.fontSize = '';
                    }
                };

                window.addEventListener('resize', setResponsiveFontSize);
                setResponsiveFontSize();

                return () => window.removeEventListener('resize', setResponsiveFontSize);
            }, []);

            const handleResizeStart = (e) => {
                if (window.innerWidth >= 1024) return;
                isResizingRef.current = true;
                document.body.style.userSelect = 'none';
            };

            useEffect(() => {
                const handleResizeMove = (e) => {
                    if (!isResizingRef.current) return;
                    let clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;
                    const windowHeight = window.innerHeight;
                    let newHeightVh = (clientY / windowHeight) * 100;
                    if (newHeightVh < 35) newHeightVh = 35;
                    if (newHeightVh > 80) newHeightVh = 80;
                    setMobileVisualHeight(newHeightVh);
                };
                const handleResizeEnd = () => {
                    isResizingRef.current = false;
                    document.body.style.userSelect = '';
                };
                window.addEventListener('mousemove', handleResizeMove);
                window.addEventListener('touchmove', handleResizeMove, { passive: false });
                window.addEventListener('mouseup', handleResizeEnd);
                window.addEventListener('touchend', handleResizeEnd);
                return () => {
                    window.removeEventListener('mousemove', handleResizeMove);
                    window.removeEventListener('touchmove', handleResizeMove);
                    window.removeEventListener('mouseup', handleResizeEnd);
                    window.removeEventListener('touchend', handleResizeEnd);
                };
            }, []);

            useEffect(() => {
                if (contentScrollRef.current) contentScrollRef.current.scrollTop = 0;
                setSimplificationPoints(getSimplificationPoints(lang));
                setAppFeatures(getAppFeatures(lang));
                setAppGallery(getAppGallery(lang));
            }, [activeTab, lang]);

            useEffect(() => {
                const heroSrc = './img/project_02/hero_img.jpg';
                const minTimePromise = new Promise(resolve => setTimeout(resolve, 1500));
                const heroPromise = new Promise((resolve) => {
                    const img = new Image();
                    img.src = heroSrc;
                    img.onload = () => resolve();
                    img.onerror = () => resolve();
                });
                Promise.all([minTimePromise, heroPromise]).then(() => setLoading(false));
            }, []);

            useEffect(() => {
                sectionsRef.current = [heroRef.current, splitRef.current];
                if (sectionsRef.current[0]) sectionsRef.current[0].classList.add('active-section');
            }, [loading]);

            const scrollToSection = (index) => {
                if (index < 0 || index >= sectionsRef.current.length || isScrollingRef.current) return;
                isScrollingRef.current = true;
                const targetSection = sectionsRef.current[index];
                const currentSection = sectionsRef.current[currentSectionIndex];
                setShowBackToHero(index > 0);
                overscrollAccumulator.current = 0;

                const tl = gsap.timeline({
                    onComplete: () => {
                        isScrollingRef.current = false;
                        setCurrentSectionIndex(index);
                        if (currentSection !== targetSection) currentSection.classList.remove('active-section');
                        targetSection.classList.add('active-section');
                    }
                });

                if (currentSectionIndex !== index) tl.to(currentSection, { opacity: 0, duration: 0.8, ease: "power2.out" });
                tl.to(mainContainerRef.current, { scrollTo: { y: targetSection.offsetTop, autoKill: false }, duration: 1.2, ease: "power2.inOut" }, "<");
                tl.to(targetSection, { opacity: 1, duration: 1, onStart: () => { targetSection.classList.add('active-section'); targetSection.style.visibility = 'visible'; } }, "-=0.8");
            };

            const handleWheel = (e) => {
                if (isScrollingRef.current) return;
                if (tabsContainerRef.current && tabsContainerRef.current.contains(e.target)) return;

                const isSplitView = currentSectionIndex === 1;
                const contentEl = contentScrollRef.current;

                if (isSplitView) {
                    if (contentEl && contentEl.contains(e.target)) {
                        const { scrollTop, scrollHeight, clientHeight } = contentEl;
                        if (e.deltaY < 0 && scrollTop <= 0) {
                            overscrollAccumulator.current += Math.abs(e.deltaY) * 2;
                        } else {
                            overscrollAccumulator.current = 0;
                            if (scrollHeight > clientHeight && e.deltaY > 0) return;
                            if (scrollHeight > clientHeight && e.deltaY < 0 && scrollTop > 0) return;
                        }
                    } else {
                        if (e.deltaY < 0) overscrollAccumulator.current += Math.abs(e.deltaY) * 2;
                        else overscrollAccumulator.current = 0;
                    }
                }
                if (e.deltaY > 0 && currentSectionIndex < sectionsRef.current.length - 1) scrollToSection(currentSectionIndex + 1);
            };

            const handleTouchStart = (e) => {
                touchStartY.current = e.touches[0].clientY;
                overscrollAccumulator.current = 0;
            };

            const handleTouchEnd = (e) => {
                if (isScrollingRef.current || isResizingRef.current) return;
                if (tabsContainerRef.current && tabsContainerRef.current.contains(e.target)) return;

                const touchEndY = e.changedTouches[0].clientY;
                const diff = touchStartY.current - touchEndY;
                const isSplitView = currentSectionIndex === 1;
                const contentEl = contentScrollRef.current;
                const isInsideContent = contentEl && contentEl.contains(e.target);

                if (Math.abs(diff) > 50 && diff > 0) {
                    overscrollAccumulator.current = 0;
                    if (isSplitView && isInsideContent) {
                        const { scrollTop, scrollHeight, clientHeight } = contentEl;
                        if (scrollHeight > clientHeight && scrollTop + clientHeight < scrollHeight - 5) return;
                    }
                    if (currentSectionIndex < sectionsRef.current.length - 1) scrollToSection(currentSectionIndex + 1);
                }
            };

            useEffect(() => {
                const container = mainContainerRef.current;
                if (container) {
                    window.addEventListener('wheel', handleWheel, { passive: false });
                    window.addEventListener('touchstart', handleTouchStart, { passive: true });
                    window.addEventListener('touchend', handleTouchEnd, { passive: true });
                }
                return () => {
                    window.removeEventListener('wheel', handleWheel);
                    window.removeEventListener('touchstart', handleTouchStart);
                    window.removeEventListener('touchend', handleTouchEnd);
                };
            }, [currentSectionIndex]);

            const goBack = () => window.location.href = "index.html#portfolio";

            const renderLeftPanel = () => {
                switch (activeTab) {
                    case 'context': return <WindowFrame src="./img/project_02/p2_01.jpg" alt="App Hero" />;
                    case 'focus': return <WindowFrame src="./img/project_02/p2_02.jpg" alt="Simplification" />;
                    case 'features': return (
                        <div className="w-full h-full p-4 lg:p-12 flex items-center justify-center">
                            <div className="w-full max-w-full h-full flex flex-col">
                                <div className="flex-1 w-full relative min-h-0">
                                    <ComparisonSlider beforeImage={activeFeature.beforeImg} afterImage={activeFeature.afterImg} />
                                </div>
                                <div className="text-center mt-2 text-xs text-gray-500 shrink-0"><i className="fas fa-arrows-alt-h mr-2"></i>{t('drag_hint')}</div>
                            </div>
                        </div>
                    );
                    case 'gallery': return <PhoneFrame src={activeGalleryImg} alt="Gallery View" />;
                    default: return null;
                }
            };

            return (
                <React.Fragment>
                    <div className={`loader ${loading ? '' : 'hidden'}`}><div className="loader-animation"></div></div>

                    <nav className="fixed top-0 left-0 w-full z-50 px-6 py-6 flex justify-between items-center pointer-events-none">
                        <button onClick={goBack} className="back-btn pointer-events-auto flex items-center justify-center h-10 w-10 bg-white/10 backdrop-blur-md border border-white/10 rounded-full text-gray-300 hover:text-white hover:border-primary/50 hover:bg-dark-lighter transition-all duration-300 shadow-lg group overflow-hidden hover:w-40">
                            <i className="fas fa-arrow-left text-primary group-hover:text-secondary flex-shrink-0"></i>
                            <span className="opacity-0 group-hover:opacity-100 max-w-0 group-hover:max-w-[200px] ml-0 group-hover:ml-2 transition-all duration-300 whitespace-nowrap overflow-hidden text-sm font-bold">{t('back_home')}</span>
                        </button>
                    </nav>

                    <button onClick={() => scrollToSection(0)} className={`fixed bottom-8 right-8 z-[100] w-12 h-12 bg-white/10 backdrop-blur-md border border-white/20 rounded-full flex items-center justify-center text-white shadow-2xl hover:bg-primary hover:border-primary hover:scale-110 transition-all duration-300 cursor-pointer ${showBackToHero ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10 pointer-events-none'}`} title="Back to Hero Section">
                        <i className="fas fa-arrow-up"></i>
                    </button>

                    <div id="main-scroller" ref={mainContainerRef}>
                        <section id="hero" ref={heroRef} className="snap-section active-section flex items-center justify-center bg-dark relative hero-bg-custom">
                            <div className="container max-w-7xl mx-auto px-8 z-20">
                                <div className="max-w-5xl text-left">
                                    <div className={`inline-block px-4 py-1 rounded-full border border-secondary/50 bg-secondary/20 text-secondary text-xs font-bold tracking-widest mb-6 ${loading ? 'opacity-0' : 'fade-in-up'}`} style={{ animationDelay: '0.1s' }}>MOBILE COMMAND CENTER</div>
                                    <h1 className={`text-5xl lg:text-7xl font-heading font-black mb-8 leading-tight text-white drop-shadow-2xl text-left ${loading ? 'opacity-0' : 'fade-in-up'}`} style={{ animationDelay: '0.2s' }}>
                                        {t('title_main')}<br /><span className="text-transparent bg-clip-text bg-gradient-to-r from-primary to-secondary">{t('title_sub')}</span>
                                    </h1>
                                    <h2 className={`text-xl md:text-2xl text-gray-300 font-light mb-12 max-w-2xl mr-auto leading-relaxed drop-shadow-md text-left ${loading ? 'opacity-0' : 'fade-in-up'}`} style={{ animationDelay: '0.3s' }}>{t('hero_desc')}</h2>
                                    <button onClick={() => scrollToSection(1)} className={`px-10 py-4 bg-primary border border-primary/50 rounded-full text-white font-bold text-lg hover:bg-white hover:text-primary transition-all shadow-[0_10px_30px_rgba(255,74,0,0.4)] transform hover:-translate-y-1 ${loading ? 'opacity-0' : 'fade-in-up'}`} style={{ animationDelay: '0.4s' }}>
                                        {t('btn_explore')} <i className="fas fa-arrow-down ml-2 animate-bounce"></i>
                                    </button>
                                </div>
                            </div>
                        </section>

                        <section id="split-view" ref={splitRef} className="snap-section flex flex-col lg:flex-row bg-dark overflow-hidden">
                            <div className="w-full shrink-0 z-20 lg:w-3/5 lg:h-full bg-dark relative border-b lg:border-b-0 lg:border-r border-white/5 flex items-center justify-center" style={{ height: window.innerWidth < 1024 ? `${mobileVisualHeight}vh` : '100%', transition: isResizingRef.current ? 'none' : 'height 0.3s ease' }}>
                                <div className="w-full h-full overflow-hidden flex items-center justify-center lg:pb-0">{renderLeftPanel()}</div>
                                <div className="lg:hidden absolute bottom-0 right-6 w-12 h-12 z-50 flex items-center justify-center cursor-row-resize touch-none translate-y-1/2" onMouseDown={handleResizeStart} onTouchStart={handleResizeStart}>
                                    <div className="w-10 h-10 bg-dark-light/90 backdrop-blur-md rounded-full shadow-[0_4px_20px_rgba(0,0,0,0.5)] border border-white/20 flex flex-col items-center justify-center transition-transform hover:scale-110 active:scale-95 group">
                                        <i className="fas fa-chevron-up text-[8px] text-gray-400 group-hover:text-primary mb-0.5"></i><div className="w-4 h-[2px] bg-gray-500 rounded-full"></div><i className="fas fa-chevron-down text-[8px] text-gray-400 group-hover:text-primary mt-0.5"></i>
                                    </div>
                                </div>
                            </div>

                            <div className="w-full relative z-10 lg:w-2/5 lg:h-full flex flex-col min-h-0">
                                <div className="w-full h-full flex flex-col glass-panel relative min-h-0">
                                    <div className="sticky top-0 bg-dark/95 backdrop-blur-xl z-30 border-b border-white/10 shrink-0">
                                        <div className="p-6 lg:p-8 pb-0 lg:pb-0">
                                            <h2 className="text-xl lg:text-3xl font-bold mb-1 font-heading">{t('title_main')}<br />{t('title_sub')}</h2>
                                            <p className="text-gray-400 text-xs lg:text-sm mb-4">Mobile Experience Optimization</p>

                                            <div ref={tabsContainerRef} className="flex space-x-6 overflow-x-auto custom-scroll mt-4 pb-2 w-full touch-pan-x">
                                                {[{ id: 'context', label: t('tab_context') }, { id: 'focus', label: t('tab_focus') }, { id: 'features', label: t('tab_features') }, { id: 'gallery', label: t('tab_gallery') }].map(tab => (
                                                    <button key={tab.id} onClick={() => setActiveTab(tab.id)} className={`text-sm font-bold whitespace-nowrap transition-colors flex-shrink-0 ${activeTab === tab.id ? 'text-primary border-b-2 border-primary pb-1' : 'text-gray-500 hover:text-white pb-1'}`}>{tab.label}</button>
                                                ))}
                                            </div>
                                        </div>
                                    </div>

                                    <div ref={contentScrollRef} className="flex-1 p-6 lg:p-8 overflow-y-auto custom-scroll pb-24 scroll-content">
                                        {activeTab === 'context' && (
                                            <div className="space-y-8 animate-fadeIn">
                                                <h3 className="text-lg md:text-2xl font-bold text-white mb-4">{t('context_title')}</h3>
                                                <p className="text-gray-300 leading-relaxed text-sm">{t('context_desc')}</p>
                                                <div className="grid grid-cols-2 gap-4 mt-6">
                                                    <div className="p-4 bg-white/5 rounded-xl border border-white/10"><i className="fas fa-mobile-alt text-primary mb-2 text-xl"></i><h4 className="font-bold text-sm">{t('mobile_first')}</h4><p className="text-xs text-gray-400 mt-1">{t('mobile_first_sub')}</p></div>
                                                    <div className="p-4 bg-white/5 rounded-xl border border-white/10"><i className="fas fa-feather-alt text-secondary mb-2 text-xl"></i><h4 className="font-bold text-sm">{t('soft_ui')}</h4><p className="text-xs text-gray-400 mt-1">{t('soft_ui_sub')}</p></div>
                                                </div>
                                            </div>
                                        )}

                                        {activeTab === 'focus' && (
                                            <div className="space-y-6 animate-fadeIn">
                                                <div className="mb-4"><h3 className="text-lg md:text-2xl font-bold text-white">{t('focus_title')}</h3><p className="text-xs text-gray-400 mt-1">{t('focus_sub')}</p></div>
                                                <div className="space-y-4">
                                                    {simplificationPoints.map((point) => (
                                                        <div key={point.id} className="feature-card p-5 border-l-4 border-l-primary hover:translate-x-1 transition-all duration-300 group">
                                                            <div className="flex items-center mb-3"><div className="w-8 h-8 rounded-full bg-secondary/20 flex items-center justify-center text-secondary mr-3"><i className={`fas ${point.icon}`}></i></div><h4 className="font-bold text-white">{point.title}</h4></div>
                                                            <div className="flex items-center justify-between text-xs mb-3 bg-black/20 p-2 rounded-lg border border-white/5">
                                                                <div className="text-gray-500 w-1/2 pr-2 border-r border-gray-700"><span className="block font-bold mb-1 text-[10px] uppercase tracking-wider opacity-70">{t('web_complex')}</span>{point.web.desc}</div>
                                                                <div className="text-secondary w-1/2 pl-2"><span className="block font-bold mb-1 text-[10px] uppercase tracking-wider opacity-70">{t('app_simple')}</span>{point.app.desc}</div>
                                                            </div>
                                                            <div className="text-xs text-gray-300 italic border-l-2 border-secondary pl-3">"{point.insight}"</div>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        )}

                                        {activeTab === 'features' && (
                                            <div className="space-y-6 animate-fadeIn">
                                                <div className="mb-4"><h3 className="text-lg md:text-2xl font-bold text-white">{t('features_title')}</h3><p className="text-xs text-gray-400 mt-1">{t('features_sub')}</p></div>
                                                <div className="space-y-3">
                                                    {appFeatures.map((feat) => (
                                                        <button key={feat.id} onClick={() => setActiveFeatureId(feat.id)} className={`w-full text-left p-4 rounded-xl border transition-all ${activeFeatureId === feat.id ? 'bg-primary/10 border-primary shadow-[0_0_15px_rgba(255,74,0,0.2)]' : 'bg-white/5 border-white/5 hover:bg-white/10'}`}>
                                                            <h4 className={`font-bold text-sm mb-1 ${activeFeatureId === feat.id ? 'text-primary' : 'text-white'}`}>{feat.title}</h4>
                                                            <p className="text-xs text-gray-400 mb-2">{feat.desc}</p>
                                                            {activeFeatureId === feat.id && <div className="text-xs text-white bg-dark/50 p-2 rounded mt-2 border-l-2 border-secondary animate-fadeIn"><i className="fas fa-lightbulb text-yellow-400 mr-1"></i> {feat.point}</div>}
                                                        </button>
                                                    ))}
                                                </div>
                                            </div>
                                        )}

                                        {activeTab === 'gallery' && (
                                            <div className="space-y-6 animate-fadeIn">
                                                <h3 className="text-lg md:text-2xl font-bold text-white mb-4">{t('gallery_title')}</h3>
                                                <div className="space-y-3">
                                                    {appGallery.map((img) => (
                                                        <button key={img.id} onClick={() => setActiveGalleryId(img.id)} className={`w-full text-left feature-card p-4 transition-all group flex items-center justify-between ${activeGalleryId === img.id ? 'border-primary bg-white/5 shadow-[0_0_15px_rgba(255,74,0,0.1)]' : 'border-white/5 hover:bg-white/5'}`}>
                                                            <div className="flex-1 min-w-0 pr-4"><div className="flex items-center mb-1"><span className={`font-bold text-sm truncate transition-colors ${activeGalleryId === img.id ? 'text-white' : 'text-gray-300 group-hover:text-white'}`}>{img.title}</span></div><p className={`text-xs truncate transition-colors ${activeGalleryId === img.id ? 'text-gray-400' : 'text-gray-600 group-hover:text-gray-500'}`}>{img.desc}</p></div>
                                                            <i className={`fas fa-chevron-right ml-4 transform transition-all text-xs ${activeGalleryId === img.id ? 'text-primary translate-x-0 opacity-100' : 'text-gray-600 -translate-x-2 opacity-0 group-hover:opacity-50'}`}></i>
                                                        </button>
                                                    ))}
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </React.Fragment>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>